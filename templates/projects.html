{% extends "base.html" %}
{% block title %}Proyectos{% endblock %}
{% block content %}
<h2 style="margin-bottom:1rem">Proyectos</h2>
<a href="/projects/new" class="btn-explorar" style="margin-bottom:1rem">+ Nuevo</a>

<table class="data-table">
 <thead><tr><th>Proyecto</th><th>Due√±o</th><th>Estado</th><th>Inicio</th><th>Fin</th></tr></thead>
 <tbody>
 {% for p in projects %}
   <tr>
     <td>{{ p.name }}</td>
     <td>{{ p.owner_email }}</td>
     <td>{{ p.status }}</td>
     <td>{{ p.start_date }}</td>
     <td>{{ p.end_date }}</td>
   </tr>
 {% endfor %}
 </tbody>
</table>

<h3 style="margin:2rem 0 .75rem">Gantt</h3>
<div id="gantt" style="width:100%;height:350px"></div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<script>
const tasks = {{ projects|tojson }};
Plotly.newPlot('gantt',[{
  type:'timeline',
  x0: tasks.map(t=>t.start_date),
  x1: tasks.map(t=>t.end_date||new Date().toISOString().slice(0,10)),
  y:  tasks.map(t=>t.name)
}],{margin:{t:10},yaxis:{autorange:'reversed'}});
</script>
{% endblock %}
